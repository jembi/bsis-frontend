<span class="h3 page-header">Manage Donation Batches</span>

<hr/>

<p>
 submitted: {{submitted}}
</p>

<h4>Open Donation Batches</h4>
<div ng-switch="openDonationBatches" class="col-sm-12">
  <div ng-switch-when="true">
  <div style="padding-bottom: 10px"></div>
    <div class="panel panel-default">
      <div class="panel-body">

        <table ng-table="donationBatchTableParams" show-filter="false" class="table">
          <tr ng-repeat="donationBatch in $data"
              ng-click="manageClinic(donationBatch); changeSelection(donationBatch);"
              ng-mouseenter="this.$selected = true"
              ng-mouseleave="this.$selected = false"
              ng-class="{'active': donationBatch.$selected}">
              <td data-title="'Date Created'" style="width:30%;" header-class="text-left" sortable="'date'">
                  {{donationBatch.createdDate}}
              </td>
              <td data-title="'Center'" style="width:25%;" header-class="text-left" sortable="'center'">
                  {{donationBatch.collectionCenter.name}}
              </td>
              <td data-title="'Site'" style="width:25%;" header-class="text-left"sortable="'site'">
                  {{donationBatch.collectionSite.name}}
              </td>
              <td data-title="'# of Donations'" style="width:20%;" header-class="text-left" class="text-center" sortable="'numDonations'">
                  {{donationBatch.numCollections}}
              </td>
          </tr>
        </table>

      </div>
    </div>
  </div>
  <div ng-switch-when="false">
    <div class="panel panel-default">
      <div class="panel-body">
        <p>
          <em> No open donation batches. </em>
        </p>
      </div>
    </div>
  </div>
</div>

<h4>New Donation Batch</h4>
<form name="addDonationBatchForm" novalidate class="form-horizontal col-sm-12" role="form" ng-submit="addDonationBatch(newDonationBatch, addDonationBatchForm)">
  <div class="form-group">
    <label for="name" class="col-sm-1 control-label">Center</label>
    <div class="row col-sm-11">
      <div class="form-inline" style="padding-left:5px;">
        <select name="center" class="form-control input-sm" ng-model="newDonationBatch.collectionCenter" ng-options="item.id as item.name for item in centers" required 
        ng-class="{'ng-invalid ng-dirty' : addDonationBatchForm.center.$invalid && submitted}">
            <option value="" ng-disabled="true"></option>
        </select>
        <span>
          <small class="error" 
            ng-show="
              (addDonationBatchForm.center.$invalid && (addDonationBatchForm.center.$dirty || submitted))
            ">
            Invalid input - required field
          </small>
        </span>
      </div>
    </div>
  </div>
  <div class="form-group">
    <label for="name" class="col-sm-1 control-label">Site</label>
    <div class="row col-sm-11">
      <div class="form-inline" style="padding-left:5px;">
        <select name="site" class="form-control input-sm" ng-model="newDonationBatch.collectionSite" ng-options="item.id as item.name for item in sites" required 
        ng-class="{'ng-invalid ng-dirty' : addDonationBatchForm.site.$invalid && submitted}" >
            <option value="" ng-disabled="true"></option>
        </select>
        <span>
          <small class="error" 
            ng-show="
              (addDonationBatchForm.site.$invalid && (addDonationBatchForm.site.$dirty || submitted))
            ">
            Invalid input - required field
          </small>
        </span>
      </div>
    </div>
  </div>

  <div class="form-group"> 
    <div class="col-sm-offset-1 col-sm-4">
      <button class="btn btn-primary" type="submit">Add Donation Batch</button>
      <button class="btn btn-primary" type="button" ng-click="clear()">Clear</button>
    </div>
  </div>

</form>

