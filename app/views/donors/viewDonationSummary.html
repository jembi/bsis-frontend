<form editable-form name="donationSummaryForm" onbeforesave="checkBleedTimes($data)" onaftersave="updateDonation(donation)">

  <span style="float: right; padding-right: 15px; font-size: 0.9em">
    <span ng-show="!donationSummaryForm.$visible">
      <em><a has-permission="{{permissions.EDIT_DONATION}}" href="" ng-click="donationSummaryForm.$show()" >Edit</a></em> | 
      <em><a href="" ng-click="viewDonationBatch()">Done</a></em>
    </span>
    <span ng-show="donationSummaryForm.$visible">
      <em>
      <button type="submit" class="btn" style="background:none!important; border:none;  cursor: pointer;" ng-disabled="donationSummaryForm.$waiting">
        Save
      </button>
      <button type="button" class="btn" style="background:none!important; border:none;  cursor: pointer;" ng-disabled="donationSummaryForm.$waiting" ng-click="donationSummaryForm.$cancel()">
        Cancel
      </button>
      </em>
    </span>
  </span>




  <div class="col-sm-10" style="height:100%;">
    <table class="dash-table">
      <tbody>
        <tr>
          <td class="field">DIN: </td>
          <td class="value">{{donation.donationIdentificationNumber}}</td>
        </tr>
        <tr>
          <td class="field">Donor #: </td>
          <td class="value">{{donation.donorNumber}}</td>
        </tr>
        <tr>
          <td class="field">Date Bled: </td>
          <td class="value">{{donation.donationDate | bsisDate }}</td>
        </tr>
        <tr>
          <td class="field">Bleed Time: </td>
          <td class="value bleed-times">
            <fieldset ng-disabled="!donation.permissions.canUpdateDonationFields">
              <table>
                <tr>
                  <td>
                    <span editable-bstime="donation.bleedStartTime" e-name="bleedStartTime"
                        e-minute-step="5"
                          e-show-spinners="donation.permissions.canUpdateDonationFields">
                      {{donation.bleedStartTime | bsisTime }}
                    </span>
                  </td>
                  <td> to </td>
                  <td>
                    <span editable-bstime="donation.bleedEndTime"
                        e-minute-step="5"  e-name="bleedEndTime"
                          e-show-spinners="donation.permissions.canUpdateDonationFields">
                      {{donation.bleedEndTime | bsisTime }}
                    </span>
                  </td>
                  <td>
                    <span ng-show="donationSummaryForm.$visible" class="error">{{ errorObject.bleedTime[0].error }}</span>
                  </td>
                </tr>
              </table>
            </fieldset>
          </td>
        </tr>
        <tr>
          <td class="field">Venue: </td>
          <td class="value">{{donation.venue.name}}</td>
        </tr>
        <tr>
          <td class="field">Pack Type: </td>
          <td class="value">
            <fieldset ng-disabled="!donation.permissions.canUpdateDonationFields">
              <span editable-select="donation.packType" e-name="packType" e-ng-options="pt as pt.packType for pt in packTypes track by pt.id">{{donation.packType.packType}}</span>
            </fieldset>
          </td>
        </tr>
        <tr>
          <td class="field">Donation Type: </td>
          <td class="value">{{donation.donationType.donationType}}</td>
        </tr>
        <tr>
          <td class="field">Pulse: </td>
          <td class="value">
            <span e-class="xeditable w50" editable-text="donation.donorPulse" e-id="donorPulse" onbeforesave="checkPulse($data)" e-name="donorPulse">{{donation.donorPulse}}</span>
            <span for="donorPulse" >{{pulseUnit}}</span>
            <span ng-show="donationSummaryForm.$visible" class="error">{{ errorObject.pulse[0].error }}</span>
          </td>
        </tr>
        <tr >
          <td class="field">Hb: </td>
          <td class="value">
            <span ng-show="getBooleanValue('donation.hbNumericValue')" e-class="xeditable w50" editable-text="donation.haemoglobinCount" onbeforesave="checkHb($data)" e-name="haemoglobinCount">{{donation.haemoglobinCount}}</span>
            <span for="haemoglobinCount">{{hbUnit}}</span>
            <span ng-show="donationSummaryForm.$visible" class="error">{{ errorObject.hb[0].error }}</span>
            <span ng-show="getBooleanValue('donation.hbNumericValue') && getBooleanValue('donation.hbQualitativeValue')"> (</span>
            <span ng-show="getBooleanValue('donation.hbQualitativeValue')" editable-select="donation.haemoglobinLevel" e-name="haemoglobinLevel" e-ng-options="l.value as l.span for l in haemoglobinLevels" style="text-transform:capitalize;">{{donation.haemoglobinLevel | lowercase}}</span>
            <span ng-show="getBooleanValue('donation.hbNumericValue') && getBooleanValue('donation.hbQualitativeValue')"> )</span>
          </td>
        </tr>
        <tr>
          <td class="field">BP: </td>
          <td class="value">
            <table>
              <tr>
                <td>
                  <span e-class="xeditable w50" editable-text="donation.bloodPressureSystolic" onbeforesave="checkBpSystolic($data)" e-name="bloodPressureSystolic">{{donation.bloodPressureSystolic}}</span>
                  <span ng-show="donationSummaryForm.$visible" class="error">{{ errorObject.bpSystolic[0].error }}</span>
                </td>
                <td>
                  /
                </td>
                <td>
                  <span e-class="xeditable w50" editable-text="donation.bloodPressureDiastolic" onbeforesave="checkBpDiastolic($data)" e-name="bloodPressureDiastolic">{{donation.bloodPressureDiastolic}}</span>
                </td>
                <td>
                  <span class="w50" for="bloodPressureDiastolic" style="float: left">{{bpUnit}}</span>
                </td>
                <td>
                  <span ng-show="donationSummaryForm.$visible" class="error">{{ errorObject.bpDiastolic[0].error }}</span>
                </td>
              </tr>
            </table>

          </td>
        </tr>
        <tr>
          <td class="field">Weight: </td>
          <td class="value">
              <span e-class="xeditable w50" editable-text="donation.donorWeight" onbeforesave="checkWeight($data)" e-name="donorWeight">{{donation.donorWeight}}</span>
              <span for="donorWeight">{{weightUnit}}</span>
              <span ng-show="donationSummaryForm.$visible" class="error">{{ errorObject.weight[0].error }}</span>
          </td>
        </tr>
        <tr>
          <td class="field">Comment: </td>
          <td class="value"><span e-class="xeditable notes" editable-text="donation.notes" e-name="notes">{{donation.notes}}</span></td>
        </tr>
        <tr>
          <td class="field">Averse Event Type: </td>
          <td class="value">
            <span e-name="adverseEventType"
                editable-select="donation.adverseEvent.type"
                e-ng-options="aet as aet.name for aet in adverseEventTypes track by aet.id">
              {{donation.adverseEvent.type.name}}
            </span>
          </td>
        </tr>
        <tr>
          <td class="field">Adverse Event Comment: </td>
          <td class="value">
            <span e-name="adverseEventComment" e-class="xeditable notes" editable-text="donation.adverseEvent.comment">
              {{donation.adverseEvent.comment}}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</form>

