<form editable-form name="donationSummaryForm" onbeforesave="validateForm(donationSummaryForm)" onaftersave="updateDonation(donation)" novalidate>

  <span style="float: right; padding-right: 15px; font-size: 0.9em">
    <span ng-show="!donationSummaryForm.$visible">
      <em><a has-permission="{{permissions.EDIT_DONATION}}" href="" ng-click="donationSummaryForm.$show()" >Edit</a></em> |
      <em><a href="" ng-click="viewDonationBatch()">Done</a></em>
    </span>
    <span ng-show="donationSummaryForm.$visible">
      <em>
      <button type="submit" class="btn" style="background:none!important; border:none;  cursor: pointer;" ng-disabled="donationSummaryForm.$waiting">
        Save
      </button>
      <button type="button" class="btn" style="background:none!important; border:none;  cursor: pointer;" ng-disabled="donationSummaryForm.$waiting" ng-click="donationSummaryForm.$cancel()">
        Cancel
      </button>
      </em>
    </span>
  </span>

  <div class="col-sm-10" style="height:100%;">
    <table class="dash-table">
      <tbody>
        <tr>
          <td class="field">DIN: </td>
          <td class="value">{{donation.donationIdentificationNumber}}</td>
        </tr>
        <tr>
          <td class="field">Donor #: </td>
          <td class="value">{{donation.donorNumber}}</td>
        </tr>
        <tr>
          <td class="field">Date Bled: </td>
          <td class="value">{{donation.donationDate | bsisDate }}</td>
        </tr>
        <tr>
          <td class="field">Bleed Time: </td>
          <td class="value bleed-times">
            <fieldset ng-disabled="!donation.permissions.canUpdateDonationFields">
              <table>
                <tr>
                  <td>
                    <span editable-bstime="donation.bleedStartTime"
                        e-minute-step="5"
                        e-show-spinners="donation.permissions.canUpdateDonationFields">
                      {{donation.bleedStartTime | bsisTime }}
                    </span>
                  </td>
                  <td> to </td>
                  <td>
                    <span editable-bstime="donation.bleedEndTime"
                        e-minute-step="5"
                        e-show-spinners="donation.permissions.canUpdateDonationFields">
                      {{donation.bleedEndTime | bsisTime }}
                    </span>
                  </td>
                </tr>
              </table>
            </fieldset>
          </td>
        </tr>
        <tr>
          <td class="field">Venue: </td>
          <td class="value">{{donation.donorPanel.name}}</td>
        </tr>
        <tr>
          <td class="field">Pack Type: </td>
          <td class="value">
            <fieldset ng-disabled="!donation.permissions.canUpdateDonationFields">
              <span editable-select="donation.packType" e-name="packType" e-ng-options="pt as pt.packType for pt in packTypes track by pt.id">{{donation.packType.packType}}</span>
            </fieldset>
          </td>
        </tr>
        <tr>
          <td class="field">Donation Type: </td>
          <td class="value">{{donation.donationType.donationType}}</td>
        </tr>
        <tr>
          <td class="field">Pulse: </td>
          <td class="value">
              <span e-class="xeditable w50" editable-number="donation.donorPulse"
                    e-ng-model-options="{ updateOn:'default blur', debounce: { default: 1000, blur: 0 } }"
                    e-max={{pulseMax}} e-min={{pulseMin}} e-decimal
                    e-name="donorPulse">{{donation.donorPulse}}</span>
              <span> {{pulseUnit}}</span>
              <br />
              <small class="error" ng-show="donationSummaryForm.donorPulse.$error.min">
                  Please enter a value above  {{pulseMin}}
              </small>
              <small class="error" ng-show="donationSummaryForm.donorPulse.$error.max">
                  Please enter a value below  {{pulseMax}}
              </small>
          </td>
        </tr>
        <tr >
          <td class="field">Hb: </td>
          <td class="value">
            <span ng-show="getBooleanValue('donation.hbNumericValue')" e-class="xeditable w50" editable-number="donation.haemoglobinCount"
                  e-ng-model-options="{ updateOn:'default blur', debounce: { default: 1000, blur: 0 } }"
                  e-min={{hbMin}} e-max={{hbMax}} e-decimal
                  e-name="haemoglobinCount">{{donation.haemoglobinCount}}</span>
              <span> {{hbUnit}}</span>

            <span ng-show="getBooleanValue('donation.hbNumericValue') && getBooleanValue('donation.hbQualitativeValue')"> (</span>
            <span ng-show="getBooleanValue('donation.hbQualitativeValue')" editable-select="donation.haemoglobinLevel" e-name="haemoglobinLevel" e-ng-options="l.value as l.label for l in haemoglobinLevels" style="text-transform:capitalize;">{{donation.haemoglobinLevel | lowercase}}</span>
            <span ng-show="getBooleanValue('donation.hbNumericValue') && getBooleanValue('donation.hbQualitativeValue')"> )</span>
              <br />
              <small class="error" ng-show="donationSummaryForm.haemoglobinCount.$error.min">
                  Please enter a value above  {{hbMin}}
              </small>
              <small class="error" ng-show="donationSummaryForm.haemoglobinCount.$error.max">
                  Please enter a value below  {{hbMax}}
              </small>
          </td>
        </tr>
        <tr>
          <td class="field">BP: </td>
          <td class="value">
              <span e-class="xeditable w50" editable-number="donation.bloodPressureSystolic"
                    e-ng-model-options="{ updateOn:'default blur', debounce: { default: 1000, blur: 0 } }"
                    e-min={{bpSystolicMin}} e-max={{bpSystolicMax}} e-decimal
                    e-name="bloodPressureSystolic">{{donation.bloodPressureSystolic}}</span>/
              <span e-class="xeditable w50" editable-number="donation.bloodPressureDiastolic"
                    e-ng-model-options="{ updateOn:'default blur', debounce: { default: 1000, blur: 0 } }"
                    e-min={{bpDiastolicMin}} e-max={{bpDiastolicMax}} e-decimal
                    e-name="bloodPressureDiastolic">{{donation.bloodPressureDiastolic}}</span>
              <span> {{bpUnit}}</span>
              <br />
              <small class="error" ng-show="donationSummaryForm.bloodPressureSystolic.$error.min">
                  Please enter a value above  {{bpSystolicMin}}
              </small>
              <small class="error" ng-show="donationSummaryForm.bloodPressureSystolic.$error.max">
                  Please enter a value below  {{bpSystolicMax}}
              </small>
              <br />
              <small class="error" ng-show="donationSummaryForm.bloodPressureDiastolic.$error.min">
                  Please enter a value above  {{bpDiastolicMin}}
              </small>
              <small class="error" ng-show="donationSummaryForm.bloodPressureDiastolic.$error.max">
                  Please enter a value below  {{bpDiastolicMax}}
              </small>
          </td>
        </tr>
        <tr>
          <td class="field">Weight: </td>
          <td class="value">
              <span e-class="xeditable w50" editable-number="donation.donorWeight"
                    e-ng-model-options="{ updateOn:'default blur', debounce: { default: 1000, blur: 0 } }"
                    e-min={{weightMin}} e-max={{weightMax}} e-decimal
                    e-name="donorWeight">{{donation.donorWeight}}</span>
              <span>{{weightUnit}}</span>
              <br />
              <small class="error" ng-show="donationSummaryForm.donorWeight.$error.min">
                  Please enter a value above  {{weightMin}}
              </small>
              <small class="error" ng-show="donationSummaryForm.donorWeight.$error.max">
                  Please enter a value below  {{weightMax}}
              </small>
          </td>
        </tr>
        <tr>
          <td class="field">Comment: </td>
          <td class="value"><span e-class="xeditable notes" editable-text="donation.notes" e-name="notes">{{donation.notes}}</span></td>
        </tr>
        <tr>
          <td class="field">Averse Event Type: </td>
          <td class="value">
            <span e-name="adverseEventType"
                editable-select="donation.adverseEvent.type"
                e-ng-options="aet as aet.name for aet in adverseEventTypes track by aet.id">
              {{donation.adverseEvent.type.name}}
            </span>
          </td>
        </tr>
        <tr>
          <td class="field">Adverse Event Comment: </td>
          <td class="value">
            <span e-name="adverseEventComment" e-class="xeditable notes" editable-text="donation.adverseEvent.comment">
              {{donation.adverseEvent.comment}}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</form>
