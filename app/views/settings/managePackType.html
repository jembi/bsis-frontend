<div class="row  main-page" ng-controller="ManagePackTypesCtrl">
    <h3 class="page-header">Manage Pack Type</h3>
    <div class="panel panel-default">
        <div class="panel-body">

          <div ng-show="serverError">
            <alert type="danger" close="serverError = null">
              {{serverError.userMessage}}
              <ul>
                <li ng-show="serverError.fieldErrors['type.packType']">{{serverError.fieldErrors['type.packType']}}</li>
                <li ng-show="serverError.fieldErrors['type.countAsDonation']">{{serverError.fieldErrors['type.countAsDonation']}}</li>
              </ul>
            </alert>
          </div>

            <form name="packTypeForm" novalidate class="form-horizontal col-sm-12"  role="form" ng-submit="savePackType(packType,packTypeForm)">
                <div>
                    <div class="row form-group col-sm-12">
                        <label for="packType" class="col-sm-2 control-label">Pack Type</label>
                        <div class="col-sm-8">
                            <div class="form-inline">
                                <input size="20" id="packType" name="packType" class="form-control input-sm" ng-model="packType.packType" required
                                       ng-minlength=1 ng-maxlength=30
                                       ng-model-options="{ updateOn:'default blur', debounce: { default: 500, blur: 0 } }"
                                       ng-class="{'ng-invalid ng-dirty' : packTypeForm.packType.$invalid && submitted}" />

                                <div>
                                    <small class="error" ng-show="(packTypeForm.packType.$error.required && (packType.packType.$dirty || submitted))">
                                        This cannot be empty
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row form-group col-sm-12">
                        <label for="testSampleProduced" class="col-sm-2 control-label">Test Sample Produced</label>
                        <div class="col-sm-8">
                            <div class="checkbox">
                                <input type="checkbox" id="testSampleProduced" name="testSampleProduced" ng-model="packType.testSampleProduced" ng-change="handleTestSampleProducedToggle()" />
                            </div>
                        </div>
                    </div>

                    <div class="row form-group col-sm-12">
                        <label for="countAsDonation" class="col-sm-2 control-label">Components Produced</label>
                        <div class="col-sm-8">
                            <div class="checkbox">
                                <input type="checkbox"
                                    id="countAsDonation"
                                    name="countAsDonation"
                                    ng-model="packType.countAsDonation"
                                    ng-change="switchCountAsDonation()"
                                    ng-disabled="!packType.testSampleProduced"
                                    ng-class="{'ng-invalid ng-dirty' : packTypeForm.countAsDonation.$invalid && submitted }" />
                            </div>
                        </div>
                    </div>

                    <div class="row form-group col-sm-12">
                        <label for="componentType" class="col-sm-2 control-label">Component Type</label>
                        <div class="col-sm-6">
                            <div class="form-inline">
                                <select ng-disabled="!packType.countAsDonation" id="componentType" name="componentType" class="form-control input-sm" ng-model="packType.componentType" ng-options="item as item.componentTypeName for item in componentTypes track by item.id"  ng-required="packType.countAsDonation"
                                        ng-class="{'ng-invalid ng-dirty' : packTypeForm.componentType.$invalid && submitted}">
                                    <option value="" ng-disabled="true">Select:</option>
                                </select>
                                <div>
                                    <small class="error"
                                           ng-show="(packTypeForm.componentType.$error.required && (packTypeForm.componentType.$dirty || submitted))">
                                        This cannot be empty
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row form-group col-sm-12">
                        <label for="periodBetweenDonations" class="col-sm-2 control-label">Donation Period</label>
                        <div class="col-sm-8">
                            <div class="form-inline">
                                <input size="3" style="width:4em;"  type="number" id="periodBetweenDonations"  name="periodBetweenDonations" class="form-control input-sm" ng-model="packType.periodBetweenDonations" required
                                       ng-minlength=1 ng-maxlength=3
                                       ng-model-options="{ updateOn:'default blur', debounce: { default: 500, blur: 0 } }"
                                       ng-class="{'ng-invalid ng-dirty' : packTypeForm.periodBetweenDonations.$invalid && submitted}"
                                /> <em>days</em>

                                <div>
                                    <small class="error" ng-show="(packTypeForm.periodBetweenDonations.$error.required && (packTypeForm.periodBetweenDonations.$dirty || submitted))">
                                        This cannot be empty
                                    </small>
                                </div>
                                <div>
                                  <small class="error"
                                    ng-show="
                                      (!packTypeForm.periodBetweenDonations.$error.required && packTypeForm.periodBetweenDonations.$invalid && (packTypeForm.periodBetweenDonations.$dirty || submitted))
                                    ">
                                    Invalid input
                                  </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-1 col-sm-10">
                        <button class="btn btn-primary" type="submit"> Save </button>
                        <button class="btn btn-primary" type="button" ng-click="clear(); go('/packTypes');">Cancel</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
